define(["base/js/namespace","base/js/utils","base/js/dialog","base/js/events"],function(t,e,n,a){return function(t){function e(a){if(n[a])return n[a].exports;var o=n[a]={exports:{},id:a,loaded:!1};return t[a].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){function a(){console.log("Linker extension (tree) loaded"),o.load(),s.load()}n(9),n(10);var o=n(23),s=n(24);t.exports={load_ipython_extension:a}},,,,,,,function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e,n){var a,o;a=[n(7),n(8)],o=function(e,n){"use strict";var a=function(){var t=n.url_path_join.apply(null,[e.notebook.base_url,"/dspace"]),a={type:"GET",processData:!1,cache:!1};return n.promising_ajax(t,a)},o=function(t){var a=n.url_path_join.apply(null,[e.notebook.base_url,"/sword"]),o={type:"POST",cache:!1,processData:!1,data:t,contentType:"application/json"};return n.promising_ajax(a,o)},s=function(t){var a=n.url_path_join.apply(null,[e.notebook.base_url,"/uploadbundle"]),o={type:"POST",processData:!1,data:t,contentType:"application/json"};return n.promising_ajax(a,o)},i=function(){var t=n.url_path_join.apply(null,[e.notebook.base_url,"/sword"]),a={processData:!1,cache:!1,type:"GET"};return n.promising_ajax(t,a)},l=function(t){var a=n.url_path_join.apply(null,[e.notebook.base_url,"/ldap"]),o={processData:!1,cache:!1,type:"POST",data:t,contentType:"application/json"};return n.promising_ajax(a,o)};t.exports={sword_get_servicedocument:i,get_collections:a,sword_new_item:o,upload_data:s,ldap_auth:l}}.apply(e,a),!(void 0!==o&&(t.exports=o))},function(t,e,n){var a,o;a=[],o=function(){"use strict";var e=function(t,e){var n=$("<div/>").addClass("alert alert-dismissible fade in").addClass(t).attr("role","alert").html(e).append($("<button/>").addClass("close").attr("type","button").attr("data-dismiss","alert").attr("aria-label","Close").append($("<span/>").attr("aria-hidden","true").html("&times;")));return $("#header").after(n),n};t.exports={create_alert:e}}.apply(e,a),!(void 0!==o&&(t.exports=o))},,function(t,e){t.exports=n},,,,function(t,e){t.exports=a},,,,,,,function(t,e,n){var a,o;a=[n(7)],o=function(){var e=function(){$(".dynamic-buttons").after($("<hr/>").attr("id","bundle-divider"));var t=$("<div/>").addClass("bundle-instructions").text("Select files and directories to associate with your chosen notebook. Note: you cannot associate notebooks with other notebooks.\n");$("#bundle-divider").after(t);var e=$("<div/>").attr("id","bundle-buttons"),n=$("<button/>").addClass("bundle-button btn btn-default btn-xs").attr("title","Associated the selected files with "+sessionStorage.getItem("bundle")).text("Bundle"),a=$("<button/>").addClass("bundle-cancel-button btn btn-default btn-xs").attr("title","Stop associating files and return to the regular tree").text("Cancel");e.append(n).append(a),$(".bundle-instructions").after(e);var o=$(".btn-upload").html();o=o.replace("Upload","Add files to current directory"),$(".btn-upload").html(o)};t.exports={load:e}}.apply(e,a),!(void 0!==o&&(t.exports=o))},function(t,e,n){var a,o;a=[n(7),n(16),n(12),n(8),n(23)],o=function(e,n,a,o){"use strict";var s,i="",l=function(){e.notebook_list.load_list(),sessionStorage.getItem("bundle")&&(i=sessionStorage.getItem("bundle")),s=!0,$(document.body).append($("<div>").attr("id","tree_extension_loaded")),$("tree_extension_loaded").remove(),$(".bundle-button").click($.proxy(e.NotebookList.prototype.bundle_selected,e.notebook_list)),$(".bundle-cancel-button").click(function(){sessionStorage.removeItem("bundle");var t=o.url_path_join(o.get_body_data("baseUrl"),"notebooks",i);window.location.assign(t)})},r={directory:0,notebook:1,file:2};e.NotebookList.prototype.draw_notebook_list_2=function(t,e,a){t.content.sort(function(t,e){return r[t.type]<r[e.type]?-1:r[t.type]>r[e.type]?1:t.name.toLowerCase()<e.name.toLowerCase()?-1:t.name.toLowerCase()>e.name.toLowerCase()?1:0});var s=e||"Notebook list empty.",i=null,l=null,d=t.content.length;this.clear_list();var p=this.element.children(".list_item").length;if(0===d){i=this.new_item(0);var c=i.children().first();c.empty(),c.append($("<div/>").css("margin","auto").css("text-align","center").css("color","grey").text(s))}var u=this.notebook_path,b=p;""!==u&&(i=this.new_item(b,!1),l={type:"directory",name:"..",path:o.url_path_split(u)[0]},this.add_link(l,i),b+=1);for(var h=0;h<d;h++){l=t.content[h],i=this.new_item(h+b,!0);try{this.add_link(l,i)}catch(t){console.log("Error adding link: "+t)}}n.trigger("draw_notebook_list.NotebookList"),a.forEach(function(t){for(var e=$(".list_item"),n=0;n<e.length;n++){var a=$(e[n]);if(a.data("path")===t.path){a.find("input[type=checkbox]").prop("checked",!0);break}}}),this._selection_changed()},e.NotebookList.prototype.draw_notebook_list=function(t,e){var n=this,a=[];if(i&&s){s=!1;var o=null;n.contents.get(i,{type:"notebook"}).then(function(s){if(o=s,o.content.hasOwnProperty("metadata")&&o.content.metadata.hasOwnProperty("databundle")){var i=o.content.metadata.databundle;i.forEach(function(t){a.push({name:t.name,path:t.path,type:t.type})})}n.draw_notebook_list_2(t,e,a)})}else a=this.selected,this.draw_notebook_list_2(t,e,a)},e.NotebookList.prototype._selection_changed=function(){var t=[],e=!1,n=!1,a=!1,s=!1,l=this,r=0;$(".list_item :checked").each(function(i,d){var p=$(d).parent().parent();0===p.find(".upload_button").length&&""!==p.data("path")&&p.data("path")!==o.url_path_split(l.notebook_path)[0]&&(r++,t.push({name:p.data("name"),path:p.data("path"),type:p.data("type")}),e=e||"notebook"===p.data("type")&&void 0!==l.sessions[p.data("path")],s=s||"notebook"===p.data("type"),a=a||"file"===p.data("type"),n=n||"directory"===p.data("type"))}),this.selected=t,1!==t.length||e||i?$(".rename-button").css("display","none"):$(".rename-button").css("display","inline-block"),t.length>=1&&!e&&!i?$(".move-button").css("display","inline-block"):$(".move-button").css("display","none"),1!==t.length||e||n||i?$(".download-button").css("display","none"):$(".download-button").css("display","inline-block"),!e||a||n||i?$(".shutdown-button").css("display","none"):$(".shutdown-button").css("display","inline-block"),t.length>0&&!n&&!i?$(".duplicate-button").css("display","inline-block"):$(".duplicate-button").css("display","none"),t.length>0&&!i?$(".delete-button").css("display","inline-block"):$(".delete-button").css("display","none"),!s&&i?($(".bundle-button").css("display","inline-block"),$(".bundle-button").attr("disabled",!1)):i?($(".bundle-button").css("display","inline-block"),$(".bundle-button").attr("disabled",!0)):$(".bundle-button").css("display","none"),i?$(".bundle-cancel-button").css("display","inline-block"):$(".bundle-cancel-button").css("display","none");var d=0;$(".list_item input[type=checkbox]").each(function(t,e){var n=$(e).parent().parent();0===n.find(".upload_button").length&&""!==n.data("path")&&n.data("path")!==o.url_path_split(l.notebook_path)[0]&&d++});var p=$("#select-all");0===r?(p.prop("checked",!1),p.prop("indeterminate",!1),p.data("indeterminate",!1)):r===d?(p.prop("checked",!0),p.prop("indeterminate",!1),p.data("indeterminate",!1)):(p.prop("checked",!1),p.prop("indeterminate",!0),p.data("indeterminate",!0)),$("#counter-select-all").html(0===r?"&nbsp;":r),r>0||i?$(".dynamic-instructions").css("display","none"):$(".dynamic-instructions").css("display","inline-block"),i?($(".bundle-instructions").css("display","inline-block"),$("#bundle-divider").css("display","block")):($(".bundle-instructions").css("display","none"),$("#bundle-divider").css("display","none"))},e.NotebookList.prototype.bundle_selected=function(){var t=this,n=[],s=null;if(i){t.contents.get(i,{type:"notebook"}).then(function(t){s=t});var l=$("<div/>").append($("<p/>").addClass("bundle-message").text("Confirm that you wish to associate these files with "+i+" :")).append($("<br/>"));t.selected.forEach(function(e){function a(e,o){t.contents.get(e,{type:"directory"}).then(function(e){var s={name:e.name,path:e.path,type:e.type};n.push(s),e.content.forEach(function(e){var s=$("<div/>").attr("class","bundled-file").attr("id",e.path).text(e.name).css("margin-left","12px");o.append(s),"directory"===e.type&&a(e.path,s),"file"===e.type&&t.contents.get(e.path,{type:"file"}).then(function(t){var e={name:t.name,path:t.path,type:t.type};n.push(e)})})})}var o=$("<div/>").text(e.path).attr("class","bundled-file").attr("id",e.path).css("margin-left","0px");l.append(o),"directory"===e.type&&a(e.path,o),"file"===e.type&&t.contents.get(e.path,{type:"file"}).then(function(t){var e={name:t.name,path:t.path,type:t.type};n.push(e)})});a.modal({title:"Bundle Data",body:l,default_button:"Cancel",buttons:{Cancel:{},Save:{class:"btn-primary",click:function(){var a=[],i=[],l=[],r=[];s.content.metadata.hasOwnProperty("databundle")&&(a=s.content.metadata.databundle,a.forEach(function(t){o.url_path_split(t.path)[0]===e.notebook_list.notebook_path?i.push(t):l.push(t)}),i.length>0?i.forEach(function(t){if("directory"===t.type){var e=t.path;l.forEach(function(t){t.path.includes(e)?i.push(t):r.push(t)})}}):r=l);var d=n.concat(r);s.content.metadata.databundle=d,t.contents.save(s.path,s).then(function(){sessionStorage.removeItem("bundle"),window.open(o.url_path_join(e.notebook_list.base_url,"notebooks",o.encode_uri_components(s.path)),"_self")})}}}})}},t.exports={load:l}}.apply(e,a),!(void 0!==o&&(t.exports=o))}])});